; Script generated by the Inno Script Studio Wizard.
; SEE THE DOCUMENTATION FOR DETAILS ON CREATING INNO SETUP SCRIPT FILES!

#define MyAppName "IMPLACAD"
#define MyAppVersion "2.4"
#define MyAppPublisher "2aCAD Global Group"
#define MyAppURL "http://www.2acad.es/"
#define MyAppEnWeb "2aCAD Global Group S.L."
#define MyAppDir "{commonappdata}\Autodesk\ApplicationPlugins\IMPLACAD.bundle"

[Setup]
; NOTE: The value of AppId uniquely identifies this application.
; Do not use the same AppId value in installers for other applications.
; (To generate a new GUID, click Tools | Generate GUID inside the IDE.)
AppId={{1D318A83-4E28-48F2-AAB6-242DEC690541}
AppName={#MyAppName}
AppVersion={#MyAppVersion}
;AppVerName={#MyAppName} {#MyAppVersion}
AppPublisher={#MyAppPublisher}
AppPublisherURL={#MyAppURL}
AppSupportURL={#MyAppURL}
AppUpdatesURL={#MyAppURL}
DefaultDirName={#MyAppDir}
DisableDirPage=yes
DefaultGroupName=2aCAD Global Group\IMPLACAD
DisableProgramGroupPage=yes
OutputDir=C:\DESARROLLO\CLIENTES\IMPLASER\IMPLACAD\INSTALADOR_Inno\SALIDA
OutputBaseFilename={#MyAppName}_x64_CONETIQUETAS_v{#MyAppVersion}
SetupIconFile=C:\DESARROLLO\CLIENTES\IMPLASER\IMPLACAD\IMPLACAD.ico
Compression=lzma
SolidCompression=yes
UsePreviousAppDir=False
UsePreviousGroup=False
UninstallDisplayIcon={uninstallexe}
ArchitecturesAllowed=x64

[Languages]
Name: "spanish"; MessagesFile: "compiler:Languages\Spanish.isl"

[Files]
Source: "C:\DESARROLLO\CLIENTES\IMPLASER\IMPLACAD\PackageContents.xml"; DestDir: "{app}"; Flags: ignoreversion; Permissions: admins-full
; {app}\Contents\Resources
Source: "C:\DESARROLLO\CLIENTES\IMPLASER\IMPLACAD\etiquetaescalera.dwg"; DestDir: "{app}\Contents\Resources"; Flags: ignoreversion; Permissions: admins-full
Source: "C:\DESARROLLO\CLIENTES\IMPLASER\IMPLACAD\IMPLACAD.ico"; DestDir: "{app}\Contents\Resources"; Flags: ignoreversion; Permissions: admins-full
Source: "C:\DESARROLLO\CLIENTES\IMPLASER\IMPLACAD\IMPLACAD.cuix"; DestDir: "{app}\Contents\Resources"; Flags: ignoreversion; Permissions: admins-full 
Source: "C:\DESARROLLO\CLIENTES\IMPLASER\IMPLACAD\rutasevacuacion.lin"; DestDir: "{app}\Contents\Resources"; Flags: ignoreversion; Permissions: admins-full
Source: "C:\DESARROLLO\CLIENTES\IMPLASER\IMPLACAD\evacuacionpri.shx"; DestDir: "{app}\Contents\Resources"; Flags: ignoreversion; Permissions: admins-full
Source: "C:\DESARROLLO\CLIENTES\IMPLASER\IMPLACAD\evacuacionsec.shx"; DestDir: "{app}\Contents\Resources"; Flags: ignoreversion; Permissions: admins-full
Source: "C:\DESARROLLO\CLIENTES\IMPLASER\IMPLACAD\EVACUACION_A4H.dwg"; DestDir: "{app}\Contents\Resources"; Flags: ignoreversion; Permissions: admins-full
Source: "C:\DESARROLLO\CLIENTES\IMPLASER\IMPLACAD\EVACUACION_A4V.dwg"; DestDir: "{app}\Contents\Resources"; Flags: ignoreversion; Permissions: admins-full
Source: "C:\DESARROLLO\CLIENTES\IMPLASER\IMPLACAD\EVACUACION_A3H.dwg"; DestDir: "{app}\Contents\Resources"; Flags: ignoreversion; Permissions: admins-full
Source: "C:\DESARROLLO\CLIENTES\IMPLASER\IMPLACAD\EVACUACION_A3V.dwg"; DestDir: "{app}\Contents\Resources"; Flags: ignoreversion; Permissions: admins-full
; {app}\Contents\Windows\2016
Source: "C:\DESARROLLO\CLIENTES\IMPLASER\IMPLACAD\bin\IMPLACAD.dll"; DestDir: "{app}\Contents\Windows\2016"; Flags: ignoreversion; Permissions: admins-full
Source: "C:\DESARROLLO\CLIENTES\IMPLASER\IMPLACAD\bin\IMPLACAD.ini"; DestDir: "{app}\Contents\Windows\2016"; Flags: ignoreversion; Permissions: admins-full
Source: "C:\DESARROLLO\CLIENTES\IMPLASER\IMPLACAD\bin\IMPLACAD.sdf"; DestDir: "{app}\Contents\Windows\2016"; Flags: ignoreversion; Permissions: admins-full
; SQL Server Compact Edition 4.0
Source: "C:\DESARROLLO\CLIENTES\IMPLASER\IMPLACAD\bin\x64\System.Data.SqlServerCe.dll"; DestDir: "{app}\Contents\Windows\2016"; Flags: ignoreversion
Source: "C:\DESARROLLO\CLIENTES\IMPLASER\IMPLACAD\bin\x64\sqlceer40ES.dll"; DestDir: "{app}\Contents\Windows\2016"; Flags: ignoreversion
Source: "C:\DESARROLLO\CLIENTES\IMPLASER\IMPLACAD\bin\x64\sqlceme40.dll"; DestDir: "{app}\Contents\Windows\2016"; Flags: ignoreversion
Source: "C:\DESARROLLO\CLIENTES\IMPLASER\IMPLACAD\bin\x64\sqlceqp40.dll"; DestDir: "{app}\Contents\Windows\2016"; Flags: ignoreversion
Source: "C:\DESARROLLO\CLIENTES\IMPLASER\IMPLACAD\bin\x64\sqlcese40.dll"; DestDir: "{app}\Contents\Windows\2016"; Flags: ignoreversion
; NOTE: Don't use "Flags: ignoreversion" on any shared system files
Source: "..\..\..\..\..\ProgramData\IMPLACAD\*"; DestDir: "{commonappdata}\IMPLACAD\"; Flags: ignoreversion createallsubdirs recursesubdirs; Permissions: everyone-full

[Icons]
Name: "{group}\..\{cm:ProgramOnTheWeb,{#MyAppEnWeb}}"; Filename: "{#MyAppURL}"; Flags: uninsneveruninstall
Name: "{group}\{cm:UninstallProgram,{#MyAppName}}"; Filename: "{uninstallexe}"
Name: "{group}\{#MyAppName}.ini"; Filename: "{app}\Contents\Windows\2016\{#MyAppName}.ini"

[UninstallDelete]
Type: filesandordirs; Name: "{app}\*.*"
Type: filesandordirs; Name: "{app}"
;Type: filesandordirs; Name: "{#MyAppDir}"

[Registry]
Root: "HKCU"; Subkey: "Software\Autodesk\AutoCAD\R20.1\ACAD-F001:40A\Variables"; ValueType: string; ValueName: "TRUSTEDPATHS"; ValueData: "C:\ProgramData\Autodesk\ApplicationPlugins\IMPLACAD.bundle\.."; Flags: createvalueifdoesntexist
Root: "HKLM"; Subkey: "SOFTWARE\Autodesk\AutoCAD\R20.1\ACAD-F001\Variables\TRUSTEDPATHS"; ValueType: string; ValueData: "C:\ProgramData\Autodesk\ApplicationPlugins\IMPLACAD.bundle\.."; Flags: createvalueifdoesntexist

[Dirs]
Name: "C:\ProgramData\IMPLACAD"; Flags: uninsneveruninstall; Permissions: everyone-full
Name: "C:\ProgramData\Autodesk\ApplicationPlugins\IMPLACAD.bundle"; Flags: deleteafterinstall uninsalwaysuninstall; Permissions: everyone-full

